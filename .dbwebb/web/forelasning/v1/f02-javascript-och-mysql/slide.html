<!doctype html>
<html class="theme-5">
<meta charset="utf-8" />
<link href="../html-slideshow.bundle.min.css" rel="stylesheet" />
<link href="../style.css" rel="stylesheet" />
<script src="https://dbwebb.se/cdn/js/html-slideshow_v1.1.0.bundle.min.js"></script>

<title>Kursen databas</title>

<script data-role="slide" type="text/html" data-markdown class="titlepage center">
# JavaScript och MySQL
## Hur koppla Javascript till MySQL
### Mikael Roos
</script>



<script data-role="slide" data-markdown type="text/html">
# Agenda

* JavaScript
* Node.js
* Asynkron programmeringsmodell
* Callback, promise, async/await
* Koppling till MySQL

</script>



<script data-role="slide" data-markdown type="text/html">
# JavaScript

* 1995, Netscape, Brendan Eich, 10 dagar
* ECMAScript standard
* ES5, ES5.1
* ES6 - ES9, ES2015 - ES2018
* Refmanual på MDN

</script>



<script data-role="slide" data-markdown type="text/html">
# Node.js

* Opensource, cross platform
* Ryan Dahl, 2009
* JS på servern fanns tidigare, men inte så poppis
* Google V8 js engine + event loop + I/O API
* 2010 kom npm
* Både klient och server, "samma" språk
* Egen refmanual

</script>



<script data-role="slide" data-markdown type="text/html">
# Asynkron programmering

* Programmeringsmodell
    * Eventstyrd
    * Asynkron
* Event loop
* Blockande I/O

</script>



<script data-role="slide" data-markdown type="text/html">
# Callbacks

```
rl.question("What to search for? ", function(search) {
    console.info(str);
});
```

```
rl.question("What to search for? ", (search) => {
    console.info(str);
});
```

</script>



<script data-role="slide" data-markdown type="text/html">
# Promise

* Ett resultat av en asynkron operation
* Pending... initial state
* Fulfilled... state of successful operation
* Rejected... state of failed operation
* Funktion returnerar ett Promise()

</script>



<script data-role="slide" data-markdown type="text/html">
# Promise...

```
function readFile(filename, enc){
    return new Promise(function (fulfill, reject) {
        fs.readFile(filename, enc, function (err, res) {
            if (err)
                reject(err);
            else
                fulfill(res);
        });
    });
}
```

</script>



<script data-role="slide" data-markdown type="text/html">
# Async och await

* En funktion som genererar ett Promise kan användas med await
* En funktion där man använder await, måste definieras som async

</script>



<script data-role="slide" data-markdown type="text/html">
# Async och await...

```
str = await readFile(filename, "UTF-8");
console.info(str);
```

</script>



<script data-role="slide" data-markdown type="text/html">
# Promisifiering

* Lägg ett lager av Promise runt en callback funktion
* Tillåter att man använder async och await
* Med Node.js funktioner (util.promisfy)
* Generellt på externa libb (promisfy-ish)

</script>



<script data-role="slide" data-markdown type="text/html">
# Koppling till MySQL

* Externt lib, via npm
* Alternativ finns
* Lager av promise, för att använda async/await
* Manualen för libbet visar hur det skall användas

</script>



<script data-role="slide" data-markdown type="text/html">
# Moduler

* Funktioner och klasser kan organiseras i moduler
* Det finns varianter av hur moduler hanteras
    * Standardiserat "ES6 import", men begränsat stöd
* Node.js har require (den tar vi)

</script>



<script data-role="slide" data-markdown type="text/html">
# Exempelprogram

* Koda exempelprogram med main och extern modul.
* Koppla till MySQL

</script>



<script data-role="slide" data-markdown type="text/html">
# Avslutningsvis

* Frågor på det?

</script>



<script data-role="slide" data-markdown type="text/html">
<!-- empty slide by intention -->
</script>
